"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),UploadArea=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uploadArea",i=arguments[1];if(_classCallCheck(this,e),this.instanceNumber=++e.instances,this.divId=t,this.options={required:!1,allowDrop:!0,allowMultiple:!0,sendTo:"https://posttestserver.com/post.php",onFilesReceived:function(e){}},this.previousProgressPercentage=0,i)for(var n=Object.keys(i),o=0;o<n.length;o++)this.options[n[o]]=i[n[o]];this.init()}return _createClass(e,[{key:"init",value:function(){var e=document.getElementById(this.divId);e&&(this.initUploadArea(e),this.initFileInput(),this.uploadArea.appendChild(this.fileInput))}},{key:"initUploadArea",value:function(e){var t=this;this.uploadArea=e,this.uploadArea.addEventListener("dragover",function(e){t.ondragover(e)}),this.uploadArea.addEventListener("drop",function(e){t.ondrop(e)}),this.uploadArea.addEventListener("click",function(e){t.fileInput.click()}),this.uploadArea.style.cursor="pointer"}},{key:"initFileInput",value:function(){var e=this;this.fileInput=document.createElement("input"),this.fileInput.type="file",this.fileInput.style.display="none",this.fileInput.id="uploadAreaFileInput"+this.instanceNumber,this.options.required&&this.fileInput.setAttribute("required",""),this.options.allowMultiple&&this.fileInput.setAttribute("multiple",""),this.fileInput.addEventListener("change",function(t){e.handleFiles(e.fileInput.files),e.fileInput.value=null})}},{key:"ondragover",value:function(e){e.preventDefault()}},{key:"handleFiles",value:function(e){if(!Array.isArray(e)){for(var t=[],i=0;i<e.length;i++)t.push(e.item(i));e=t}console.log(e),this.options.onFilesReceived(e),this.options.upload?this.options.upload(e):this.upload(e)}},{key:"ondrop",value:function(e){if(this.options.allowDrop){e.preventDefault();var t=e.dataTransfer;if(t.items){var i=[];if(this.options.allowMultiple)for(var n=0;n<t.items.length;n++){var o=t.items[n];if("file"==o.kind){var s=o.getAsFile();i.push(s)}}else t.items.length>0&&i.push(t.items[0].getAsFile());this.handleFiles(i)}}}},{key:"onComplete",value:function(e){this.options.complete&&this.options.complete(e)}},{key:"onError",value:function(e){this.options.error&&this.options.error(e)}},{key:"upload",value:function(e){var t=this;if(e&&e.length>0){var i=new FormData;e.forEach(function(e){i.append(e.name,e)});var n=new XMLHttpRequest;n.open("POST",this.options.sendTo,!0),n.upload.onprogress=function(e){t.options.progress&&t.options.progress(e)},n.onload=function(){200==n.status?t.onComplete(n.responseText):t.onError(n.responseText)},n.send(i)}}}],[{key:"hideElement",value:function(e){var t=document.getElementById(e);t&&(t.style.display="none")}},{key:"showElement",value:function(e){var t=document.getElementById(e);t&&(t.style.display="block")}}]),e}();UploadArea.instances=0;