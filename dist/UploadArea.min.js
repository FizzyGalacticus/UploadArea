"use strict";function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,s){for(var t=0;t<s.length;t++){var n=s[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(s,t,n){return t&&e(s.prototype,t),n&&e(s,n),s}}();if(!document.getElementById("css-percentage-circle")){var link=document.createElement("link");link.id="css-percentage-circle",link.rel="stylesheet",link.href="https://cdn.rawgit.com/afuersch/css-percentage-circle/c9f4ea10/css/circle.css",document.head.appendChild(link)}var UploadArea=function(){function e(s,t){var n=this;if(_classCallCheck(this,e),this.divId=s,this.options={allowDrop:!0,allowMultiple:!0,sendTo:"https://posttestserver.com/post.php",progressArea:"UploadAreaProgress",progressColor:"green",onFilesReceived:function(e){}},this.previousProgressPercentage=0,t)for(var o=Object.keys(t),r=0;r<o.length;r++)this.options[o[r]]=t[o[r]];var i=document.getElementById(this.divId);if(i){i.addEventListener("dragover",function(e){n.ondragover(e)}),i.addEventListener("drop",function(e){n.ondrop(e)}),i.addEventListener("click",function(e){var s=document.getElementById("fileInput");s.click()}),i.style.cursor="pointer";var l=document.createElement("input");l.type="file",l.style.display="none",l.id="fileInput",this.options.allowMultiple&&l.setAttribute("multiple",""),l.addEventListener("change",function(e){n.handleFiles(l.files)}),i.appendChild(l)}var a=document.getElementById(this.options.progressArea);a&&(e.hideElement(this.options.progressArea),a.innerHTML='<div id="cssProgressArea" class="c100 p0 '+this.options.progressColor+'"><span id="cssProgressAreaSpan"></span><div class="slice"><div class="bar"></div><div class="fill"></div></div></div>')}return _createClass(e,[{key:"ondragover",value:function(e){e.preventDefault()}},{key:"handleFiles",value:function(e){this.options.onFilesReceived(e),this.options.upload?this.options.upload(e):this.upload(e)}},{key:"ondrop",value:function(e){if(this.options.allowDrop){e.preventDefault();var s=e.dataTransfer;if(s.items){var t=[];if(this.options.allowMultiple)for(var n=0;n<s.items.length;n++){var o=s.items[n];if("file"==o.kind){var r=o.getAsFile();t.push(r)}}else s.items.length>0&&t.push(s.items[0].getAsFile());this.handleFiles(t)}}}},{key:"resetProgress",value:function(){var e=document.getElementById("cssProgressArea");if(e){var s=document.getElementById("cssProgressAreaSpan");s.innerHTML="0%",e.classList.remove("p100"),e.classList.add("p0")}}},{key:"onComplete",value:function(e){this.options.complete&&this.options.complete(e)}},{key:"onError",value:function(e){this.options.complete&&this.options.complete(e)}},{key:"onProgress",value:function(s){if(e.hideElement(this.divId),e.showElement(this.options.progressArea),s.lengthComputable){var t=Math.floor(s.loaded/s.total*100),n=document.getElementById("cssProgressArea");if(n){var o=document.getElementById("cssProgressAreaSpan");o.innerHTML=t+"%",n.classList.remove("p"+this.previousProgressPercentage),n.classList.add("p"+t)}100==t&&(e.showElement(this.divId),e.hideElement(this.options.progressArea),this.previousProgressPercentage=0),this.previousProgressPercentage=t}}},{key:"upload",value:function(s,t){var n=this;if(s&&s.length>0){for(var o=new FormData,r=0;r<s.length;r++){var i=s[r];o.append(i.name,i)}if(t)for(var l=Object.keys(t),a=0;a<l.length;a++)o.append(l[a],t[l[a]]);var p=new XMLHttpRequest;p.open("POST",this.options.sendTo,!0),p.upload.onprogress=function(e){n.options.progress?n.options.progress(e):n.onProgress(e)},p.onload=function(){200==p.status?n.onComplete(p.responseText):n.onError(p.responseText)},p.send(o),this.options.progress||(this.resetProgress(),e.showElement(this.options.progressArea),e.hideElement(this.divId))}}}],[{key:"hideElement",value:function(e){var s=document.getElementById(e);s&&(s.style.display="none")}},{key:"showElement",value:function(e){var s=document.getElementById(e);s&&(s.style.display="block")}}]),e}();